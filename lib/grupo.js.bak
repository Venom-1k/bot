  const { getBuffer } = require('./myfunc')
  const Jimp = require('jimp')
const reSize = async(buffer, ukur1, ukur2) => {
    return new Promise(async(resolve, reject) => {
        var baper = await Jimp.read(buffer);
        var ab = await baper.resize(ukur1, ukur2).getBufferAsync(Jimp.MIME_JPEG)
        resolve(ab)
    })
}
  const groupResponse = async (venom, anu) => {
   const metadata = await venom.groupMetadata(anu.id)   
   for (let participant of anu.participants) {
   console.log(anu, 'Removendo nÃºmero fake')
   if (anu.action == 'add'){
      if (!anu.participants[0].startsWith(55)){
      await venom.sendMessage(anu.id, { text: 'ğŸ¤§nÃºmero fake nÃ£o sÃ£o permitidos neste grupo'})  
      

   					return venom.groupParticipantsUpdate(anu.id, 
		          	[anu.participants[0]],
		          	"remove");					
                        
					}		
					}			
    try{
       let metadata = await venom.groupMetadata(anu.id)
       let participants = anu.participants
       for (let num of participants) {
         try {
                    ppuser = await venom.profilePictureUrl(num, 'image')
                } catch {
                    ppuser = 'https://i0.wp.com/www.gambarunik.id/wp-content/uploads/2019/06/Top-Gambar-Foto-Profil-Kosong-Lucu-Tergokil-.jpg'
                }

                
                try {
                    ppgroup = await venom.profilePictureUrl(anu.id, 'image')
                } catch {
                    ppgroup = 'https://i0.wp.com/www.gambarunik.id/wp-content/uploads/2019/06/Top-Gambar-Foto-Profil-Kosong-Lucu-Tergokil-.jpg'
                }
         if (anu.action == 'add') {
          var button = [
             { 
              buttonId: `menu`, 
              buttonText: { 
               displayText: `êª¶êª¶áµ‡áµ‰áµ áµ›â±â¿áµˆáµ’ áµƒáµ’ áµÊ³áµ˜áµ–áµ’êª¶êª¶` 
               }, type: 1 
              }
             ]
        venom.sendMessage(
         anu.id, 
         { 
         caption: `*ğ˜–ğ˜­ğ˜¢ @${num.split("@")[0]} ğ˜´ğ˜¦ğ˜«ğ˜¢ ğ˜£ğ˜¦ğ˜® ğ˜·ğ˜ªğ˜¯ğ˜¥ğ˜° ğ˜¢ğ˜° ğ˜¨ğ˜³ğ˜¶ğ˜±ğ˜° ${metadata.subject} *`, 
         location: { 
          jpegThumbnail: await reSize(ppuser, 200, 200) 
         }, 
         buttons: button, 
         footer: 'ğ˜‰ğ˜º ğ˜ğ˜¦ğ˜¯ğ˜°ğ˜® ~ ğ˜”ğ˜°ğ˜¥ğ˜´', mentions: [num] })
         } 
        else 
        if (anu.action == 'remove') {
          var button = [
             { 
              buttonId: `adeus`, 
              buttonText: { 
               displayText: `êª¶êª¶á´¬áµˆáµ‰áµ˜Ë¢êª¶êª¶` 
               }, type: 1 
              }
             ]
        venom.sendMessage(
           anu.id, 
          { 
           caption: `*ğ˜°ğ˜­@${num.split("@")[0]} ğ˜´ğ˜¢ğ˜ªğ˜¶ ğ˜¥ğ˜° ğ˜¨ğ˜³ğ˜¶ğ˜±ğ˜° ${metadata.subject}*`, 
           location: { jpegThumbnail: await reSize(ppuser, 200, 200) 
          }, 
           buttons: button, 
           footer: 'ğ˜‰ğ˜º ğ˜ğ˜¦ğ˜¯ğ˜°ğ˜® ~ ğ˜”ğ˜°ğ˜¥ğ˜´', 
           mentions: [num] 
             }
             )
             }
            }
        } catch (err) {
        console.log(err)
      }
    }   
  }
module.exports = { groupResponse }  
